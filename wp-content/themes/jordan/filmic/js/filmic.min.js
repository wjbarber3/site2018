function chooseDirector(e){e.preventDefault(),$("#film-grid").empty(),$("#actor-container").empty(),$("#loader").show();var i=$(e.target).text();$("h1#director-name").text(i);var t=firebase.database().ref("Films/"+i);t.once("value").then(function(e){var i=e.val();setTimeout(function(){buildFilms(i),buildActorInput(i),$("#loader").hide()},500)})}function buildFilms(e){for(i=0;i<e.length;i++){var t=e[i].Actors.length,a=e[i].Writer.length,r=$("<div id='film"+i+"' class='film film-card col-sm-6 col-md-4'><div class='film-heading'><a target='blank' href='' class='film-link'></a></div><div class='film-info'><img class='film-poster' /><div class='film-details'><div class='film-actors'><span><h2>Starring:</h2><div class='sep'></div></span></div><div class='film-writers'><span><h2>Written By:</h2><div class='sep'></div></span></div><div class='film-year'><span><h2>Year: </h2></span></div></div></div></div>"),n=$("<h1></h1>");n.text(e[i].Title),$("#film-grid").append(r),$("#film"+i).children(".film-heading").append(n),listActors(e,t),listWriters(e,a),showYear(e),appendLink(e),showImage(e)}}function listActors(e,t){for(subindex=0;subindex<t;subindex++){var a=$("<h2 class='actor'></h2>");a.text(e[i].Actors[subindex]),$("#film"+i).find(".film-actors").append(a)}}function listWriters(e,t){for(subindex=0;subindex<t;subindex++){var a=$("<h2 class='actor'></h2>");a.text(e[i].Writer[subindex]),$("#film"+i).find(".film-writers").append(a)}}function showYear(e){var t=$("<h4></h4>");t.text(e[i].Year),$("#film"+i).find(".film-year").append(t)}function appendLink(e){var t=$("a.film-link");t.prop("href","http://www.imdb.com/title/"+e[i].id)}function showImage(e){var t=e[i].Title,a=t.replace(/\s+/g,"-").toLowerCase();$("#film"+i).find("img.film-poster").prop("src","/wp-content/themes/jordan/filmic/img/posters/"+a+".jpg")}function buildActorInput(e){var t=[];for(i=0;i<e.length;i++){var a=e[i].Actors.length;for(subindex=0;subindex<a;subindex++)t.push(e[i].Actors[subindex])}var r=[];$.each(t,function(e,i){$.inArray(i,r)===-1&&r.push(i)}),r.forEach(function(e,i){var t=e.replace(/\s+/g,"-").toLowerCase();$("#actor-container").append("<div class='checkbox'><input id='actor"+i+"' type='checkbox' value='"+t+"'><label for='actor"+i+"'>"+e+"</label></div>")})}function yearSearch(e){e.preventDefault(),$(".film").hide(),$("#loader").fadeIn(),resetTitle(),resetActors();var i=$("#year").val(),t=i[0],a=$(".film h4");setTimeout(function(){a.each(function(){var e=$(this).text(),i=e[2];i===t?$(this).closest(".film").show():"0"===t&&$(".film").show()}),$("#loader").hide()},500)}function actorSearch(e){$(".film").hide(),$("#loader").fadeIn(),e.preventDefault(),resetYear(),resetTitle();var i=$(".film"),t=$("#actor-search input:checked").map(function(){return $(this).val()}).get();i.each(function(){var e=$(this).find("h2");e.each(function(){var e=$(this).text().replace(/\s+/g,"-").toLowerCase(),i=this;setTimeout(function(){t.includes(e)?$(i).closest(".film").show():t.length<1&&$(".film").show(),$("#loader").hide()},500)})})}function narrowActors(){var e=$("#actor-input").val().toLowerCase();$("#actor-container").find(".checkbox").hide().filter(function(){return this.innerText.toLowerCase().indexOf(e)>-1}).show()}function titleSearch(){$(".film").hide(),$("#loader").fadeIn(),resetYear(),resetActors();var e=$("#title").val().toLowerCase(),i=$(".film h1");setTimeout(function(){i.each(function(){var i=$(this).text().toLowerCase();i.includes(e)&&$(this).closest(".film").show()}),$("#loader").hide()},500)}function resetYear(){var e=$("#year option:selected");e.prop("selected",!1)}function resetTitle(){var e=$("#title");e.val("")}function resetActors(){var e=$("#actor-search input");e.prop("checked",!1),$("#actor-input").val("").trigger("keyup")}function clearSearch(e){e.preventDefault(),resetActors(),resetTitle(),resetYear(),$(".film").show()}var config={apiKey:"AIzaSyCZ5caTddl4zYkKhCCvzxwuoH7FQ0u2HIk",authDomain:"filmic2-e7af3.firebaseapp.com",databaseURL:"https://filmic2-e7af3.firebaseio.com",storageBucket:"filmic2-e7af3.appspot.com",messagingSenderId:"254290584375"};firebase.initializeApp(config);var directorQuery=firebase.database().ref("Directors");directorQuery.once("value").then(function(e){var i=e.val();i.forEach(function(e){$("#director-list").append("<li class='col-sm-3'><a href='#' onclick='chooseDirector(event)'>"+e+"</a></li>")}),PageRoute.init()}),PageRoute={currentPage:".filmic-page.active",directorLink:"#director-list li a",init:function(){$(this.directorLink).click(this.updatePage.bind(this))},updatePage:function(){$(this.currentPage).removeClass("active").next().addClass("active")}};